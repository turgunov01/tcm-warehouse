import{_ as k,a as S}from"./Dxqsq03p.js";import{_ as j}from"./WaFNkPel.js";import{_ as D}from"./Bg2tV3qA.js";import{e as L,i as N,j as V,q,c as u,a as t,b as n,l as e,w as b,r as x,o as d,F,x as I,t as _,m as M,y as h}from"./C3nFx1By.js";import{u as O}from"./YQB72Io7.js";import{u as R}from"./BOtwTEl-.js";import"./BNwErHV-.js";const U={class:"space-y-4"},$={class:"card-grid"},A={class:"grid gap-4 xl:grid-cols-[2fr_1fr]"},E={class:"space-y-2"},P={class:"text-sm font-medium"},T={class:"text-sm text-slate-600"},W={key:0,class:"text-sm text-slate-500"},Z=L({__name:"index",setup(z){const{user:m}=N(),{fetchBookings:g,fetchTenantDebt:y}=O(),{bookingStatusLabel:p}=R(),r=x([]),i=x(0),v=h(()=>r.value.slice(0,6)),l=h(()=>{const s={pending:0,approved:0,rejected:0,completed:0};for(const a of r.value)s[a.status]!==void 0&&(s[a.status]+=1);return s}),f=async()=>{const s=m.value?.id;if(!s){r.value=[],i.value=0;return}r.value=await g({tenantIds:[s]}),i.value=await y(s)};return V(f),q(()=>m.value?.id,()=>{f()}),(s,a)=>{const c=k,w=S,B=j,C=D;return d(),u("div",U,[a[1]||(a[1]=t("div",null,[t("h1",{class:"text-2xl font-semibold"},"Панель арендатора"),t("p",{class:"text-sm text-slate-500"},"Сводка бронирований и текущая задолженность.")],-1)),t("div",$,[n(c,{label:"Общий долг",value:e(i),tone:"danger"},null,8,["value"]),n(c,{label:"В ожидании",value:e(l).pending,tone:"warning"},null,8,["value"]),n(c,{label:"Одобрено",value:e(l).approved,tone:"success"},null,8,["value"]),n(c,{label:"Завершено",value:e(l).completed},null,8,["value"])]),t("div",A,[n(w,{title:"Мои статусы",labels:Object.keys(e(l)).map(o=>e(p)(o)),values:Object.values(e(l))},null,8,["labels","values"]),n(C,null,{header:b(()=>[...a[0]||(a[0]=[t("p",{class:"font-semibold"},"Последние бронирования",-1)])]),default:b(()=>[t("div",E,[(d(!0),u(F,null,I(e(v),o=>(d(),u("div",{key:o.id,class:"rounded border border-[#eeeeee] p-3"},[t("p",P,_(new Date(o.requested_datetime).toLocaleString()),1),t("p",T,_(o.driver_name)+" • "+_(o.car_plate_text),1),n(B,{class:"mt-2",label:e(p)(o.status),color:"gray",variant:"subtle"},null,8,["label"])]))),128)),e(v).length?M("",!0):(d(),u("p",W,"Пока нет бронирований."))])]),_:1})])])}}});export{Z as default};
